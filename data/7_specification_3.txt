図 5 バトル画面構成 (結果表示時)


BGM
- BGM 再生は停止し、勝敗に応じたジングルが再生されます

UI
- 結果に応じた画像が表示されます
- 画面遷移はフェード表現を伴います

ユーザインタラクション
- 画面のどこでもいいのでタップするとユニット編成画面に遷移します

ゲームシステム
ユニットのスポーン
- ユニットはユニットごとに設定されたコストを消費することでスポーンさせることができます
- スポーンする位置は各ユニットの陣営の拠点の位置です
- コストが不足している場合にはスポーンすることが出来ません
- 敵 AI のユニットは、リモートから取得したステージ情報に基づいて自動的にスポーンされます
ユニットの状態
ユニットは状態を持ち、それぞれの状態に応じた行動を自律的に行います。
また、パラメータの変動などによって自律的に状態が変化します。

図 6 ユニットの状態概要
| 名称 | 概要 | 遷移条件 |
| --- | --- | --- |
| IDLE | 非戦闘状態<br />前進する |・デフォルトの状態<br />・ENGAGED 状態から敵を倒す<br /><br />・ENGAGED 状態の敵が KNOCK_BACK 状態になる<br />・KNOCK_BACK 状態から所定フレーム経過後に体力が 1 以上の場合 |
| ENGAGED | 戦闘中 | ・IDLE 状態で敵と接触する |
| KNOCK_BACK | ノックバック中 | ・ENGAGED 状態から一定割合のダメージを受ける |
| DEAD | 死亡 | ・KNOCK_BACK 状態から所定フレーム経過後に体力が 1 未満の場合 |
| WAIT | 待機 | ・システムからのみ遷移 |


図 7 ユニットの状態と遷移

ユニットのパラメータ
ユニットは個別にパラメータを有し、それらはマスターデータとテンポラリデータの二種類に分類されます。
マスターデータはリモートから取得される情報を元にした固定値で、テンポラリデータはゲームの進行状況に応じて更新されます。

図 8 ユニットのパラメータ
| 名前 | 用途 | 種別 |
| --- | --- | --- |
| unitId | ユニット ID | マスターデータ |
| cost | ユニットコスト | マスターデータ |
| maxHealth | 最大体力 | マスターデータ |
| power | 攻撃力 | マスターデータ |
| speed | 移動速度 | マスターデータ |
| knockBackFrames | ノックバックフレーム数 | マスターデータ |
| knockBackSpeed | ノックバック移動速度 | マスターデータ |
| id | スポーン毎に発行される ID | テンポラリデータ |
| isPlayer | プレイヤー側であるかどうか | テンポラリデータ |
| state | ユニットの状態 | テンポラリデータ |
| currentHealth | 現在の体力 | テンポラリデータ |
| currentFrameDamage | 現在のフレームで受けているダメージ累積<br />(ノックバック判定に利用) | テンポラリデータ |
| currentKnockBackFrameCount | ノックバック経過フレーム数 | テンポラリデータ |
| distance | 拠点からの論理距離 | テンポラリデータ |
| engagedEntity | 接敵中のエンティティ | テンポラリデータ |


拠点
拠点も攻撃対象であるという意味では、ユニットと大きな部分で違いはありません。
ユニットが拠点に対して攻撃をしている場合でも、基本的には図 7のような状態遷移を行います。
拠点側も図7の状態遷移を行いますが、歩行はせず攻撃の手段を持っていないので攻撃を受けるだけとなります。
差分は下記のとおりです。